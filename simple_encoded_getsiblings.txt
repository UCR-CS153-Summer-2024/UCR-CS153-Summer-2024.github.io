#include "types.h"
#include "user.h"

int test_two_sibs() {
    int wait_status;

    int child1_pid = fork();    
    if (child1_pid == 0) {          
        sleep(100);             
        getsiblings();          
        exit(0);                
    }

    int child2_pid = fork();
    if (child2_pid == 0) {
        sleep(100);
        exit(0);                
    }

    int child3_pid = fork();
    if (child3_pid == 0) {
        sleep(100);
        exit(0);                
    }

    wait(&wait_status);         
    wait(&wait_status);         
    wait(&wait_status);        

    exit(0);                    
}

int test_one_sibs() {
    int wait_status;

    int child_pid = fork();    
    if (child_pid == 0) {          
        sleep(100);   

        int child_child1_pid = fork(); 
        if (child_child1_pid == 0) {
            sleep(100);
            getsiblings();
            exit(0);                
        } 

        int child_child2_pid = fork();
        if (child_child2_pid == 0) {
            sleep(100);
            exit(0);                
        }        
        
        wait(&wait_status);         
        wait(&wait_status);         
        exit(0);                
    }

    wait(&wait_status);        
    exit(0);  
}

int test_zero_sibs() {
    int wait_status;

    int child_pid = fork();    
    if (child_pid == 0) {          
        sleep(100);   

        int child_child1_pid = fork(); 
        if (child_child1_pid == 0) {
            sleep(100);

            int child_child_child1_pid = fork();
            if (child_child_child1_pid == 0) {
                sleep(100);
                getsiblings();
                exit(0);                
            }       
            
            wait(&wait_status);
            exit(0);                
        } 

        wait(&wait_status);         
        exit(0);                
    }

    wait(&wait_status);        
    exit(0);   
}

int main(int argc, char *argv[]) {
    if (atoi(argv[1]) == 2) {
        test_two_sibs();  
    } else if (atoi(argv[1]) == 1) {
        test_one_sibs();
    } else if (atoi(argv[1]) == 0) {
        test_zero_sibs(); 
    } else {
        printf(1, "The argument is not correct!\n");
        return -1;
    }

    return 0;
}
